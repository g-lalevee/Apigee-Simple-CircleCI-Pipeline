version: 2.1

jobs:
  deploy_apigee_proxy:
    docker:
      - image: maven:latest
    environment:
      API_VERSION: "googleapi"
      APIGEE_ENV: default-env
      APIGEE_ORG: bap-emea-apigee-5
    steps:
      - run:
          name: Provision VPC and EKS cluster
          command: |
            pwd
            ls ../*
            sed -i "s/target_apigee_env/$APIGEE_ENV/g" ../EdgeConfig/edge.json
            mvn install -Pgoogleapi -Dapigee.org=$c -Denv=$APIGEE_ENV -Dsa=$GCP_SERVICE_ACCCOUNT -Dapigee.config.file=./EdgeConfig/edge.json -Dapigee.config.options=update
  
          
workflows:
  version: 2
  dev_plan:
    jobs:
      - deploy_apigee_proxy
